<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>使用 Github actions 自动发布 Hugo 博客 | Jimall's Blog</title><meta name=keywords content="Tutorial,GitHub Actions"><meta name=description content="使用 hugo 写博客的时候，每次增加文章，需要本地构建之后发布到 github 上通过 github pages 服务展示页面，不难想到可以使用 CI 的方法，将构建的过程自动化，实现写博文 push 到 github 即可自动构建并发布到 github pages。
搞的过程中坑比较多，记录为一个教程，供各位参考。
我折腾过程中的参考：https://tianhui.xin/blog/2019/11/17/hugousegithubactionstopages/
创建代码仓库和 github pages 仓库 构建过程中采用两个仓库：
代码仓库，github pages 在这里构建并发布，我们设为 username.github.io.source github pages 仓库，用于存放构建好的文件，github pages 服务会根据构建好的文件展示我们的博。客，我们设为 username.github.io （username 改为你自己的 github username） 简单说来就是根据代码仓库的文件构建，构建好之后发布到 github pages 仓库，github pages 仓库由于有 github 提供的服务，会自动展示我们的 blog。
创建 github pages 仓库 没啥特别，github 上创建一个空仓库 username.github.io
创建代码仓库 这个仓库和我们本地直接关联，创建有一些细节需要注意，我下面的过程给各位参考：
github 创建空仓库 username.github.io.source
本地找个空文件夹，比如叫 HugoBlog，进去之后初始化 Hugo Blog：hugo new site . 初始化 git 仓库：git init 添加主题文件，这步需要注意，需要使用 git submodule 来进行（照着做就完了，不需要深入了解），比如我这边采用的主题文件为 joway/hugo-theme-yinyang，那么命令为：git submodule add git@github."><meta name=author content="Jimall"><link rel=canonical href=https://jimall-blog.vercel.app/posts/technology/github-acitons/><link crossorigin=anonymous href=/assets/css/stylesheet.min.48a18943c2fc15c38a372b8dde1f5e5dc0bc64fa6cb90f5a817d2f8c76b7f3ae.css integrity="sha256-SKGJQ8L8FcOKNyuN3h9eXcC8ZPpsuQ9agX0vjHa3864=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.e85ad0406048e8176e1c7661b25d5c69297ddfe41dc4124cf75ecb99a4f7b3d1.js integrity="sha256-6FrQQGBI6BduHHZhsl1caSl93+QdxBJM917LmaT3s9E=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://jimall-blog.vercel.app/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jimall-blog.vercel.app/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jimall-blog.vercel.app/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://jimall-blog.vercel.app/apple-touch-icon.png><link rel=mask-icon href=https://jimall-blog.vercel.app/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="使用 Github actions 自动发布 Hugo 博客"><meta property="og:description" content="使用 hugo 写博客的时候，每次增加文章，需要本地构建之后发布到 github 上通过 github pages 服务展示页面，不难想到可以使用 CI 的方法，将构建的过程自动化，实现写博文 push 到 github 即可自动构建并发布到 github pages。
搞的过程中坑比较多，记录为一个教程，供各位参考。
我折腾过程中的参考：https://tianhui.xin/blog/2019/11/17/hugousegithubactionstopages/
创建代码仓库和 github pages 仓库 构建过程中采用两个仓库：
代码仓库，github pages 在这里构建并发布，我们设为 username.github.io.source github pages 仓库，用于存放构建好的文件，github pages 服务会根据构建好的文件展示我们的博。客，我们设为 username.github.io （username 改为你自己的 github username） 简单说来就是根据代码仓库的文件构建，构建好之后发布到 github pages 仓库，github pages 仓库由于有 github 提供的服务，会自动展示我们的 blog。
创建 github pages 仓库 没啥特别，github 上创建一个空仓库 username.github.io
创建代码仓库 这个仓库和我们本地直接关联，创建有一些细节需要注意，我下面的过程给各位参考：
github 创建空仓库 username.github.io.source
本地找个空文件夹，比如叫 HugoBlog，进去之后初始化 Hugo Blog：hugo new site . 初始化 git 仓库：git init 添加主题文件，这步需要注意，需要使用 git submodule 来进行（照着做就完了，不需要深入了解），比如我这边采用的主题文件为 joway/hugo-theme-yinyang，那么命令为：git submodule add git@github."><meta property="og:type" content="article"><meta property="og:url" content="https://jimall-blog.vercel.app/posts/technology/github-acitons/"><meta property="og:image" content="https://jimall-blog.vercel.app/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-05-31T00:00:00+00:00"><meta property="article:modified_time" content="2022-05-06T05:28:22+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jimall-blog.vercel.app/papermod-cover.png"><meta name=twitter:title content="使用 Github actions 自动发布 Hugo 博客"><meta name=twitter:description content="使用 hugo 写博客的时候，每次增加文章，需要本地构建之后发布到 github 上通过 github pages 服务展示页面，不难想到可以使用 CI 的方法，将构建的过程自动化，实现写博文 push 到 github 即可自动构建并发布到 github pages。
搞的过程中坑比较多，记录为一个教程，供各位参考。
我折腾过程中的参考：https://tianhui.xin/blog/2019/11/17/hugousegithubactionstopages/
创建代码仓库和 github pages 仓库 构建过程中采用两个仓库：
代码仓库，github pages 在这里构建并发布，我们设为 username.github.io.source github pages 仓库，用于存放构建好的文件，github pages 服务会根据构建好的文件展示我们的博。客，我们设为 username.github.io （username 改为你自己的 github username） 简单说来就是根据代码仓库的文件构建，构建好之后发布到 github pages 仓库，github pages 仓库由于有 github 提供的服务，会自动展示我们的 blog。
创建 github pages 仓库 没啥特别，github 上创建一个空仓库 username.github.io
创建代码仓库 这个仓库和我们本地直接关联，创建有一些细节需要注意，我下面的过程给各位参考：
github 创建空仓库 username.github.io.source
本地找个空文件夹，比如叫 HugoBlog，进去之后初始化 Hugo Blog：hugo new site . 初始化 git 仓库：git init 添加主题文件，这步需要注意，需要使用 git submodule 来进行（照着做就完了，不需要深入了解），比如我这边采用的主题文件为 joway/hugo-theme-yinyang，那么命令为：git submodule add git@github."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://jimall-blog.vercel.app/posts/"},{"@type":"ListItem","position":2,"name":"使用 Github actions 自动发布 Hugo 博客","item":"https://jimall-blog.vercel.app/posts/technology/github-acitons/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"使用 Github actions 自动发布 Hugo 博客","name":"使用 Github actions 自动发布 Hugo 博客","description":"使用 hugo 写博客的时候，每次增加文章，需要本地构建之后发布到 github 上通过 github pages 服务展示页面，不难想到可以使用 CI 的方法，将构建的过程自动化，实现写博文 push 到 github 即可自动构建并发布到 github pages。\n搞的过程中坑比较多，记录为一个教程，供各位参考。\n我折腾过程中的参考：https://tianhui.xin/blog/2019/11/17/hugousegithubactionstopages/\n创建代码仓库和 github pages 仓库 构建过程中采用两个仓库：\n代码仓库，github pages 在这里构建并发布，我们设为 username.github.io.source github pages 仓库，用于存放构建好的文件，github pages 服务会根据构建好的文件展示我们的博。客，我们设为 username.github.io （username 改为你自己的 github username） 简单说来就是根据代码仓库的文件构建，构建好之后发布到 github pages 仓库，github pages 仓库由于有 github 提供的服务，会自动展示我们的 blog。\n创建 github pages 仓库 没啥特别，github 上创建一个空仓库 username.github.io\n创建代码仓库 这个仓库和我们本地直接关联，创建有一些细节需要注意，我下面的过程给各位参考：\ngithub 创建空仓库 username.github.io.source\n本地找个空文件夹，比如叫 HugoBlog，进去之后初始化 Hugo Blog：hugo new site . 初始化 git 仓库：git init 添加主题文件，这步需要注意，需要使用 git submodule 来进行（照着做就完了，不需要深入了解），比如我这边采用的主题文件为 joway/hugo-theme-yinyang，那么命令为：git submodule add git@github.","keywords":["Tutorial","GitHub Actions"],"articleBody":"使用 hugo 写博客的时候，每次增加文章，需要本地构建之后发布到 github 上通过 github pages 服务展示页面，不难想到可以使用 CI 的方法，将构建的过程自动化，实现写博文 push 到 github 即可自动构建并发布到 github pages。\n搞的过程中坑比较多，记录为一个教程，供各位参考。\n我折腾过程中的参考：https://tianhui.xin/blog/2019/11/17/hugousegithubactionstopages/\n创建代码仓库和 github pages 仓库 构建过程中采用两个仓库：\n代码仓库，github pages 在这里构建并发布，我们设为 username.github.io.source github pages 仓库，用于存放构建好的文件，github pages 服务会根据构建好的文件展示我们的博。客，我们设为 username.github.io （username 改为你自己的 github username） 简单说来就是根据代码仓库的文件构建，构建好之后发布到 github pages 仓库，github pages 仓库由于有 github 提供的服务，会自动展示我们的 blog。\n创建 github pages 仓库 没啥特别，github 上创建一个空仓库 username.github.io\n创建代码仓库 这个仓库和我们本地直接关联，创建有一些细节需要注意，我下面的过程给各位参考：\ngithub 创建空仓库 username.github.io.source\n本地找个空文件夹，比如叫 HugoBlog，进去之后初始化 Hugo Blog：hugo new site . 初始化 git 仓库：git init 添加主题文件，这步需要注意，需要使用 git submodule 来进行（照着做就完了，不需要深入了解），比如我这边采用的主题文件为 joway/hugo-theme-yinyang，那么命令为：git submodule add git@github.com:joway/hugo-theme-yinyang.git themes/yinyang 然后根据主题去配置去添加文章，用 hugo serve 看看效果，确定配置没问题\n然后是关键的一部，添加 workflows 文件，用于 github actions 构建。创建 .github/workflows/gh-pages.yml 文件，将下面的内容复制进去，并且根据自己的情况修改下面 TODO 表明的类。\nname: github pages CI # 自动化的名称，随便取 on: push: # push的时候触发 branches: - main # TODO 改成 username.github.io.source 的对应主分支 jobs: build: runs-on: ubuntu-latest steps: - name: checkout uses: actions/checkout@master with: submodules: true - name: Setup Hugo uses: peaceiris/actions-hugo@v2 with: hugo-version: '0.83.1' extended: true - name: Build run: hugo --minify - name: Deploy uses: peaceiris/actions-gh-pages@v3 with: deploy_key: ${{ secrets.ACTIONS_DEPLOY_KEY }} # 这个 ACTIONS_DEPLOY_KEY 需要注意，后面会用到 external_repository: username/username.github.io # TODO 改成对应的仓库名 publish_branch: main # TODO 发布到 username.github.io 的相应分支 publish_dir: ./public 需要知道的是，基本上最后搞不出来都会是因为这个文件，所以务必仔细检查配置，如果配置正确的情况下还是出现问题那么需要去看 hugo github actions 的提供方的文档，也就是 peaceiris/actions-gh-pages 这个项目。（我就是网上折腾了好久发现是配置不对 xD）\n添加公钥和私钥。代码仓库需要有 github pages 的写入权限，需要添加公钥和私钥：（注意这个和 github 添加 ssh 链接的私钥不一样，无论如何都要做这一步）\n使用 ssh-keygen -t rsa -b 4096 -C \"$(git config user.email)\" 创建公钥私钥，在当前文件夹生成即可： 将生产后的私钥（不带后缀名的）添加到代码仓库，仓库的 Settings 中点击 Secrets，然后添加咱们刚刚生成的私钥，name 为 ACTIONS_DEPLOY_KEY，注意 name 一定要是这个，因为上面的文件中配置的是这个名字 然后将公钥（带 pub 后缀名的）添加到 github pages 仓库，Settings 中点击 Deploy keys，添加公钥，Allow write access一定要勾上，否则会无法提交 公钥和私钥可以删掉，后面不需要了 将代码仓库 add commit push 到远程，基本操作，不多赘述\n查看代码仓库的 actions，这个时候基本会 build 完成，如果失败了仔细检查步骤。\nothers 本次折腾过程中看到一些不了解的东西，打算去折腾一下：\n非对称加密 git submodule ","wordCount":"229","inLanguage":"en","datePublished":"2021-05-31T00:00:00Z","dateModified":"2022-05-06T05:28:22.43Z","author":{"@type":"Person","name":"Jimall"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://jimall-blog.vercel.app/posts/technology/github-acitons/"},"publisher":{"@type":"Organization","name":"Jimall's Blog","logo":{"@type":"ImageObject","url":"https://jimall-blog.vercel.app/favicon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jimall-blog.vercel.app/ accesskey=h title="Jimall's Blog (Alt + H)">Jimall's Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://jimall-blog.vercel.app/about/ title=About><span>About</span></a></li><li><a href=https://jimall-blog.vercel.app/categories title=Categories><span>Categories</span></a></li><li><a href=https://jimall-blog.vercel.app/archives title=Archive><span>Archive</span></a></li><li><a href=https://jimall-blog.vercel.app/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://jimall-blog.vercel.app/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>使用 Github actions 自动发布 Hugo 博客</h1><div class=post-meta><span title='2021-05-31 00:00:00 +0000 UTC'>May 31, 2021</span>&nbsp;·&nbsp;Jimall</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%88%9b%e5%bb%ba%e4%bb%a3%e7%a0%81%e4%bb%93%e5%ba%93%e5%92%8c-github-pages-%e4%bb%93%e5%ba%93 aria-label="创建代码仓库和 github pages 仓库">创建代码仓库和 github pages 仓库</a><ul><li><a href=#%e5%88%9b%e5%bb%ba-github-pages-%e4%bb%93%e5%ba%93 aria-label="创建 github pages 仓库">创建 github pages 仓库</a></li><li><a href=#%e5%88%9b%e5%bb%ba%e4%bb%a3%e7%a0%81%e4%bb%93%e5%ba%93 aria-label=创建代码仓库>创建代码仓库</a></li></ul></li><li><a href=#others aria-label=others>others</a></li></ul></div></details></div><div class=post-content><p>使用 hugo 写博客的时候，每次增加文章，需要本地构建之后发布到 github 上通过 github pages 服务展示页面，不难想到可以使用 CI 的方法，将构建的过程自动化，实现写博文 push 到 github 即可自动构建并发布到 github pages。</p><p>搞的过程中坑比较多，记录为一个教程，供各位参考。</p><p>我折腾过程中的参考：<a href=https://tianhui.xin/blog/2019/11/17/hugousegithubactionstopages/>https://tianhui.xin/blog/2019/11/17/hugousegithubactionstopages/</a></p><h2 id=创建代码仓库和-github-pages-仓库>创建代码仓库和 github pages 仓库<a hidden class=anchor aria-hidden=true href=#创建代码仓库和-github-pages-仓库>#</a></h2><p>构建过程中采用两个仓库：</p><ol><li>代码仓库，github pages 在这里构建并发布，我们设为 <code>username.github.io.source</code></li><li>github pages 仓库，用于存放构建好的文件，github pages 服务会根据构建好的文件展示我们的博。客，我们设为 <code>username.github.io</code>
（username 改为你自己的 github username）</li></ol><p>简单说来就是根据代码仓库的文件构建，构建好之后发布到 github pages 仓库，github pages 仓库由于有 github 提供的服务，会自动展示我们的 blog。</p><h3 id=创建-github-pages-仓库>创建 github pages 仓库<a hidden class=anchor aria-hidden=true href=#创建-github-pages-仓库>#</a></h3><p>没啥特别，github 上创建一个空仓库 <code>username.github.io</code></p><h3 id=创建代码仓库>创建代码仓库<a hidden class=anchor aria-hidden=true href=#创建代码仓库>#</a></h3><p>这个仓库和我们本地直接关联，创建有一些细节需要注意，我下面的过程给各位参考：</p><ol><li><p>github 创建空仓库 <code>username.github.io.source</code></p></li><li><p>本地找个空文件夹，比如叫 <code>HugoBlog</code>，进去之后初始化 Hugo Blog：<code>hugo new site .</code>
<img loading=lazy src=https://cdn.jsdelivr.net/gh/shangjihao/images/blog/20210531130745.png alt></p></li><li><p>初始化 git 仓库：<code>git init</code>
<img loading=lazy src=https://cdn.jsdelivr.net/gh/shangjihao/images/blog/20210531130806.png alt></p></li><li><p>添加主题文件，这步需要注意，需要使用 git submodule 来进行（照着做就完了，不需要深入了解），比如我这边采用的主题文件为 <code>joway/hugo-theme-yinyang</code>，那么命令为：<code>git submodule add git@github.com:joway/hugo-theme-yinyang.git themes/yinyang</code>
<img loading=lazy src=https://cdn.jsdelivr.net/gh/shangjihao/images/blog/20210531130855.png alt></p></li><li><p>然后根据主题去配置去添加文章，用 <code>hugo serve</code> 看看效果，确定配置没问题</p></li><li><p>然后是关键的一部，添加 workflows 文件，用于 github actions 构建。创建 <code>.github/workflows/gh-pages.yml</code> 文件，将下面的内容复制进去，并且根据自己的情况修改下面 TODO 表明的类。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>github pages CI</span><span class=w> </span><span class=c># 自动化的名称，随便取</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=nt>push</span><span class=p>:</span><span class=w> </span><span class=c># push的时候触发</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>             </span><span class=nt>branches</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>             </span>- <span class=l>main</span><span class=w> </span><span class=c># TODO 改成 username.github.io.source 的对应主分支</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=nt>build</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>checkout</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>             </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>             </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                 </span><span class=nt>submodules</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Setup Hugo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>             </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>peaceiris/actions-hugo@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>             </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                 </span><span class=nt>hugo-version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;0.83.1&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                 </span><span class=nt>extended</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>             </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>hugo --minify</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>             </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>peaceiris/actions-gh-pages@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>             </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                 </span><span class=nt>deploy_key</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.ACTIONS_DEPLOY_KEY }}</span><span class=w> </span><span class=c># 这个 ACTIONS_DEPLOY_KEY 需要注意，后面会用到</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                 </span><span class=nt>external_repository</span><span class=p>:</span><span class=w> </span><span class=l>username/username.github.io</span><span class=w> </span><span class=c># TODO 改成对应的仓库名</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                 </span><span class=nt>publish_branch</span><span class=p>:</span><span class=w> </span><span class=l>main</span><span class=w> </span><span class=c># TODO 发布到 username.github.io 的相应分支</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                 </span><span class=nt>publish_dir</span><span class=p>:</span><span class=w> </span><span class=l>./public</span><span class=w>
</span></span></span></code></pre></div><p>需要知道的是，基本上最后搞不出来都会是因为这个文件，所以务必仔细检查配置，如果配置正确的情况下还是出现问题那么需要去看 hugo github actions 的提供方的文档，也就是 peaceiris/actions-gh-pages 这个项目。（我就是网上折腾了好久发现是配置不对 xD）</p></li><li><p>添加公钥和私钥。代码仓库需要有 github pages 的写入权限，需要添加公钥和私钥：（注意这个和 github 添加 ssh 链接的私钥不一样，无论如何都要做这一步）</p><ol><li>使用 <code>ssh-keygen -t rsa -b 4096 -C "$(git config user.email)"</code> 创建公钥私钥，在当前文件夹生成即可：
<img loading=lazy src=https://cdn.jsdelivr.net/gh/shangjihao/images/blog/20210531143428.png alt></li><li>将生产后的私钥（不带后缀名的）添加到代码仓库，仓库的 Settings 中点击 Secrets，然后添加咱们刚刚生成的私钥，name 为 ACTIONS_DEPLOY_KEY，注意 name 一定要是这个，因为上面的文件中配置的是这个名字</li><li>然后将公钥（带 pub 后缀名的）添加到 github pages 仓库，Settings 中点击 Deploy keys，添加公钥，Allow write access一定要勾上，否则会无法提交</li><li>公钥和私钥可以删掉，后面不需要了</li></ol></li><li><p>将代码仓库 add commit push 到远程，基本操作，不多赘述</p></li><li><p>查看代码仓库的 actions，这个时候基本会 build 完成，如果失败了仔细检查步骤。</p></li></ol><h2 id=others>others<a hidden class=anchor aria-hidden=true href=#others>#</a></h2><p>本次折腾过程中看到一些不了解的东西，打算去折腾一下：</p><ol><li>非对称加密</li><li><a href=/posts/technology/git-submodule/>git submodule</a></li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://jimall-blog.vercel.app/tags/tutorial/>Tutorial</a></li><li><a href=https://jimall-blog.vercel.app/tags/github-actions/>GitHub Actions</a></li></ul><nav class=paginav><a class=prev href=https://jimall-blog.vercel.app/posts/technology/git-submodule/><span class=title>« Prev Page</span><br><span>git submodule 的使用</span></a>
<a class=next href=https://jimall-blog.vercel.app/posts/technology/usage-of-gitignore/><span class=title>Next Page »</span><br><span>.gitignore 的写法</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share 使用 Github actions 自动发布 Hugo 博客 on twitter" href="https://twitter.com/intent/tweet/?text=%e4%bd%bf%e7%94%a8%20Github%20actions%20%e8%87%aa%e5%8a%a8%e5%8f%91%e5%b8%83%20Hugo%20%e5%8d%9a%e5%ae%a2&url=https%3a%2f%2fjimall-blog.vercel.app%2fposts%2ftechnology%2fgithub-acitons%2f&hashtags=Tutorial%2cGitHubActions"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 使用 Github actions 自动发布 Hugo 博客 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fjimall-blog.vercel.app%2fposts%2ftechnology%2fgithub-acitons%2f&title=%e4%bd%bf%e7%94%a8%20Github%20actions%20%e8%87%aa%e5%8a%a8%e5%8f%91%e5%b8%83%20Hugo%20%e5%8d%9a%e5%ae%a2&summary=%e4%bd%bf%e7%94%a8%20Github%20actions%20%e8%87%aa%e5%8a%a8%e5%8f%91%e5%b8%83%20Hugo%20%e5%8d%9a%e5%ae%a2&source=https%3a%2f%2fjimall-blog.vercel.app%2fposts%2ftechnology%2fgithub-acitons%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 使用 Github actions 自动发布 Hugo 博客 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fjimall-blog.vercel.app%2fposts%2ftechnology%2fgithub-acitons%2f&title=%e4%bd%bf%e7%94%a8%20Github%20actions%20%e8%87%aa%e5%8a%a8%e5%8f%91%e5%b8%83%20Hugo%20%e5%8d%9a%e5%ae%a2"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 使用 Github actions 自动发布 Hugo 博客 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fjimall-blog.vercel.app%2fposts%2ftechnology%2fgithub-acitons%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 使用 Github actions 自动发布 Hugo 博客 on whatsapp" href="https://api.whatsapp.com/send?text=%e4%bd%bf%e7%94%a8%20Github%20actions%20%e8%87%aa%e5%8a%a8%e5%8f%91%e5%b8%83%20Hugo%20%e5%8d%9a%e5%ae%a2%20-%20https%3a%2f%2fjimall-blog.vercel.app%2fposts%2ftechnology%2fgithub-acitons%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 使用 Github actions 自动发布 Hugo 博客 on telegram" href="https://telegram.me/share/url?text=%e4%bd%bf%e7%94%a8%20Github%20actions%20%e8%87%aa%e5%8a%a8%e5%8f%91%e5%b8%83%20Hugo%20%e5%8d%9a%e5%ae%a2&url=https%3a%2f%2fjimall-blog.vercel.app%2fposts%2ftechnology%2fgithub-acitons%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://jimall-blog.vercel.app/>Jimall's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>