<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>git submodule 的使用 | Jimall's Blog</title>
<meta name=keywords content="Git"><meta name=description content="在 hugo blog 中，会用到 git submodule，本文介绍这个特性的使用"><meta name=author content><link rel=canonical href=https://jimall.github.io/posts/technology/git-submodule/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://jimall.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jimall.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jimall.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://jimall.github.io/apple-touch-icon.png><link rel=mask-icon href=https://jimall.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://jimall.github.io/posts/technology/git-submodule/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="git submodule 的使用"><meta property="og:description" content="在 hugo blog 中，会用到 git submodule，本文介绍这个特性的使用"><meta property="og:type" content="article"><meta property="og:url" content="https://jimall.github.io/posts/technology/git-submodule/"><meta property="og:image" content="https://jimall.github.io/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-05-31T00:00:00+00:00"><meta property="article:modified_time" content="2022-05-06T05:27:49+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jimall.github.io/papermod-cover.png"><meta name=twitter:title content="git submodule 的使用"><meta name=twitter:description content="在 hugo blog 中，会用到 git submodule，本文介绍这个特性的使用"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://jimall.github.io/posts/"},{"@type":"ListItem","position":2,"name":"git submodule 的使用","item":"https://jimall.github.io/posts/technology/git-submodule/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"git submodule 的使用","name":"git submodule 的使用","description":"在 hugo blog 中，会用到 git submodule，本文介绍这个特性的使用","keywords":["Git"],"articleBody":"在 Git 项目中，需要包含别的 Git 项目，我们希望能够独立的使用这两个项目。比如我们的博客是一个 Git 项目，而我们需要在博客中包含别人的项目作为博客主题，我们希望能够在自己写博文后 push 不影响博客主题仓库，同时希望能够独立使用主题仓库，这样我们就可以获取最新的主题。\n这个时候需要用到 git submodule。在使用 submodule 之后，两个项目便相对独立（或者多个 submodule，那么就是多个项目相对独立）。下面介绍子模块常用的用法：\n使用子模块 添加子模块 在 Git 项目中包含别的 Git 项目，不能够直接到相应文件夹 clone，而需要使用 git add submodule 命令，可以将这个命令视为子模块版本的 git clone。\ngit add submodule git@github.com/example/example.git submodule 上面的命令将项目克隆到 submodule 目录。会发现根目录生成了一个 .gitmodule 文件，这个文件用于保存子模块信息。\n查看子模块 使用 git submodule 命令查看当前项目的子模块。\n更新子模块 在项目中使用 git update 父模块并不会更新子模块。（别的操作同理，我们在项目中使用的各种以前使用的 git 操作都只会对父模块产生作用）\n使用 git submodule add 添加子项目。\n操作子模块 在子模块的文件夹内部，我们的各种操作都是对子模块的项目产生作用，比如 push 就是将子模块 push 到子模块的 remote repository。\n所以需要单独修改子模块，只需要 cd 到子模块内，把子模块当成一个普通的 git 项目即可。\n克隆含有子模块的项目 克隆包含子模块的项目有两种方法：\n先克隆父项目，再更新子模块 递归克隆整个项目。 先克隆父项目，再更新子模块 这种方法有以下步骤：\n克隆父项目：git clone xxx。注意这种情况下，像之前说的，在父项目中的操作，只对父项目产生作用，所以子项目不会被 clone。 查看子模块：git submodule。会发现子模块前面有一个 -，说明子模块文件还未被 clone（为空文件夹）。 $ git submodule -e33f854d3f51f5ebd771a68da05ad0371a3c0570 xxx 初始化子模块：git submodule init。在父模块 clone 之后运行一次，就行了。 更新子模块：git submodule update。运行后子模块被 clone，整个项目就 ready 了。 递归克隆整个项目 clone 的时候，添加 --recursive 指令，递归克隆子模块，一步到位。\ngit clone xxxx --recursive 删除子模块 删除子模块比较麻烦，需要手动删除相关的文件，否则在添加子模块时有可能出现错误\n以删除 assets 文件夹为例\n删除子模块文件夹\n$ git rm --cached assets $ rm -rf assets 删除 .gitmodules 文件中相关子模块信息\n[submodule \"assets\"] path = assets url = https://github.com/maonx/vimwiki-assets.git 删除 .git/config 中的相关子模块信息\n[submodule \"assets\"] url = https://github.com/maonx/vimwiki-assets.git 删除 .git 文件夹中的相关子模块文件\n$ rm -rf .git/modules/assets ","wordCount":"149","inLanguage":"en","datePublished":"2021-05-31T00:00:00Z","dateModified":"2022-05-06T05:27:49.393Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://jimall.github.io/posts/technology/git-submodule/"},"publisher":{"@type":"Organization","name":"Jimall's Blog","logo":{"@type":"ImageObject","url":"https://jimall.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jimall.github.io/ accesskey=h title="Jimall's Blog (Alt + H)">Jimall's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://jimall.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://jimall.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">git submodule 的使用</h1><div class=post-description>在 hugo blog 中，会用到 git submodule，本文介绍这个特性的使用</div><div class=post-meta><span title='2021-05-31 00:00:00 +0000 UTC'>May 31, 2021</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e4%bd%bf%e7%94%a8%e5%ad%90%e6%a8%a1%e5%9d%97 aria-label=使用子模块>使用子模块</a><ul><li><a href=#%e6%b7%bb%e5%8a%a0%e5%ad%90%e6%a8%a1%e5%9d%97 aria-label=添加子模块>添加子模块</a></li><li><a href=#%e6%9f%a5%e7%9c%8b%e5%ad%90%e6%a8%a1%e5%9d%97 aria-label=查看子模块>查看子模块</a></li><li><a href=#%e6%9b%b4%e6%96%b0%e5%ad%90%e6%a8%a1%e5%9d%97 aria-label=更新子模块>更新子模块</a></li><li><a href=#%e6%93%8d%e4%bd%9c%e5%ad%90%e6%a8%a1%e5%9d%97 aria-label=操作子模块>操作子模块</a></li></ul></li><li><a href=#%e5%85%8b%e9%9a%86%e5%90%ab%e6%9c%89%e5%ad%90%e6%a8%a1%e5%9d%97%e7%9a%84%e9%a1%b9%e7%9b%ae aria-label=克隆含有子模块的项目>克隆含有子模块的项目</a><ul><li><a href=#%e5%85%88%e5%85%8b%e9%9a%86%e7%88%b6%e9%a1%b9%e7%9b%ae%e5%86%8d%e6%9b%b4%e6%96%b0%e5%ad%90%e6%a8%a1%e5%9d%97 aria-label=先克隆父项目，再更新子模块>先克隆父项目，再更新子模块</a></li><li><a href=#%e9%80%92%e5%bd%92%e5%85%8b%e9%9a%86%e6%95%b4%e4%b8%aa%e9%a1%b9%e7%9b%ae aria-label=递归克隆整个项目>递归克隆整个项目</a></li></ul></li><li><a href=#%e5%88%a0%e9%99%a4%e5%ad%90%e6%a8%a1%e5%9d%97 aria-label=删除子模块>删除子模块</a></li></ul></div></details></div><div class=post-content><p>在 Git 项目中，需要包含别的 Git 项目，我们希望能够独立的使用这两个项目。比如我们的博客是一个 Git 项目，而我们需要在博客中包含别人的项目作为博客主题，我们希望能够在自己写博文后 push 不影响博客主题仓库，同时希望能够独立使用主题仓库，这样我们就可以获取最新的主题。</p><p>这个时候需要用到 git submodule。在使用 submodule 之后，两个项目便相对独立（或者多个 submodule，那么就是多个项目相对独立）。下面介绍子模块常用的用法：</p><h2 id=使用子模块>使用子模块<a hidden class=anchor aria-hidden=true href=#使用子模块>#</a></h2><h3 id=添加子模块>添加子模块<a hidden class=anchor aria-hidden=true href=#添加子模块>#</a></h3><p>在 Git 项目中包含别的 Git 项目，不能够直接到相应文件夹 clone，而需要使用 <code>git add submodule</code> 命令，可以将这个命令视为子模块版本的 <code>git clone</code>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git add submodule git@github.com/example/example.git submodule
</span></span></code></pre></div><p>上面的命令将项目克隆到 submodule 目录。会发现根目录生成了一个 .gitmodule 文件，这个文件用于保存子模块信息。</p><h3 id=查看子模块>查看子模块<a hidden class=anchor aria-hidden=true href=#查看子模块>#</a></h3><p>使用 <code>git submodule</code> 命令查看当前项目的子模块。</p><h3 id=更新子模块>更新子模块<a hidden class=anchor aria-hidden=true href=#更新子模块>#</a></h3><p>在项目中使用 <code>git update</code> 父模块并不会更新子模块。（别的操作同理，我们在项目中使用的各种以前使用的 git 操作都只会对父模块产生作用）</p><p>使用 <code>git submodule add</code> 添加子项目。</p><h3 id=操作子模块>操作子模块<a hidden class=anchor aria-hidden=true href=#操作子模块>#</a></h3><p>在子模块的文件夹内部，我们的各种操作都是对子模块的项目产生作用，比如 push 就是将子模块 push 到子模块的 remote repository。</p><p>所以需要单独修改子模块，只需要 cd 到子模块内，把子模块当成一个普通的 git 项目即可。</p><h2 id=克隆含有子模块的项目>克隆含有子模块的项目<a hidden class=anchor aria-hidden=true href=#克隆含有子模块的项目>#</a></h2><p>克隆包含子模块的项目有两种方法：</p><ol><li>先克隆父项目，再更新子模块</li><li>递归克隆整个项目。</li></ol><h3 id=先克隆父项目再更新子模块>先克隆父项目，再更新子模块<a hidden class=anchor aria-hidden=true href=#先克隆父项目再更新子模块>#</a></h3><p>这种方法有以下步骤：</p><ol><li>克隆父项目：<code>git clone xxx</code>。注意这种情况下，像之前说的，在父项目中的操作，只对父项目产生作用，所以子项目不会被 clone。</li><li>查看子模块：<code>git submodule</code>。会发现子模块前面有一个 <code>-</code>，说明子模块文件还未被 clone（为空文件夹）。<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git submodule
</span></span><span style=display:flex><span>-e33f854d3f51f5ebd771a68da05ad0371a3c0570 xxx
</span></span></code></pre></div></li><li>初始化子模块：<code>git submodule init</code>。在父模块 clone 之后运行一次，就行了。</li><li>更新子模块：<code>git submodule update</code>。运行后子模块被 clone，整个项目就 ready 了。</li></ol><h3 id=递归克隆整个项目>递归克隆整个项目<a hidden class=anchor aria-hidden=true href=#递归克隆整个项目>#</a></h3><p>clone 的时候，添加 <code>--recursive</code> 指令，递归克隆子模块，一步到位。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone xxxx --recursive
</span></span></code></pre></div><h2 id=删除子模块>删除子模块<a hidden class=anchor aria-hidden=true href=#删除子模块>#</a></h2><p>删除子模块比较麻烦，需要手动删除相关的文件，否则在添加子模块时有可能出现错误</p><p>以删除 assets 文件夹为例</p><ol><li><p>删除子模块文件夹</p><pre tabindex=0><code>$ git rm --cached assets
$ rm -rf assets
</code></pre></li><li><p>删除 .gitmodules 文件中相关子模块信息</p><pre tabindex=0><code>[submodule &#34;assets&#34;]
    path = assets
    url = https://github.com/maonx/vimwiki-assets.git
</code></pre></li><li><p>删除 .git/config 中的相关子模块信息</p><pre tabindex=0><code>[submodule &#34;assets&#34;]
    url = https://github.com/maonx/vimwiki-assets.git
</code></pre></li><li><p>删除 .git 文件夹中的相关子模块文件</p><pre tabindex=0><code>$ rm -rf .git/modules/assets
</code></pre></li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://jimall.github.io/tags/git/>Git</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://jimall.github.io/>Jimall's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>