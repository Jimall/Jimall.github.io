<!doctype html><html class="h-full w-full font-sans" lang=en-us><head><meta charset=utf-8><link rel="shortcut icon" href=https://Jimall.github.io/favicon.ico type=image/x-icon><meta name=viewport content="width=device-width,initial-scale=1"><title>Java 集合框架 Map 接口 - BLOG</title><link rel=stylesheet href=/css/styles.min.6c8705011aa916dccc613f24e45a76180281f6c816eea3c2e2dfc7d2ddbc6c7dd69fa5a184495bdb33d93d3acbba21e0a216cf851381a83de64371ea3d62e6d2.css integrity=sha512-bIcFARqpFtzMYT8k5Fp2GAKB9sgW7qPC4t/H0t28bH3Wn6WhhElb2zPZPTrLuiHgohbPhROBqD3mQ3HqPWLm0g==><script>localStorage.theme==='dark'||!('theme'in localStorage)&&window.matchMedia('(prefers-color-scheme: dark)').matches?document.documentElement.classList.add('dark'):document.documentElement.classList.remove('dark')</script></head><body class="flex flex-col items-center w-full"><main class="w-full sm:w-10/12 md:w-9/12 lg:w-7/12 xl:w-5/12 m-auto px-6"><header class="mt-9 mb-8"><div class="flex justify-between items-center"><div class="flex items-center"><input id=navbar_btn class=hidden type=checkbox>
<label for=navbar_btn class="menu-btn mr-4 items-center flex xl:hidden"><span class=navicon></span></label><a href=/technology/ class="font-bold text-lg xl:text-2xl mr-auto">BLOG</a></div><div class="flex items-center"><div class="cursor-pointer ml-2"><svg id="dark_mode_btn" class="hidden" width="18" height="18" viewBox="0 0 24 24"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 15.31 23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69zM12 18c-3.31.0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6z"/></svg></svg><svg id="light_mode_btn" class="hidden" width="18" height="18" viewBox="0 0 24 24"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><g><path d="M0 0h24v24H0V0z" fill="none"/></g><g><g><g><path d="M14 2c1.82.0 3.53.5 5 1.35C16.01 5.08 14 8.3 14 12s2.01 6.92 5 8.65C17.53 21.5 15.82 22 14 22 8.48 22 4 17.52 4 12S8.48 2 14 2z"/></g></g></g></svg></svg></div><div id=translation_wrapper class="relative flex items-center cursor-pointer text-xs ml-2 py-2"><svg id="translation_btn" width="18" height="18" viewBox="0 0 24 24"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93.0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55.0 1-.45 1-1V7h2c1.1.0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41.0 2.08-.8 3.97-2.1 5.39z"/></svg></svg>
<span class="hidden ml-1 sm:block">Technology</span><ul id=translation_menu class="absolute top-full left-0 rounded hidden w-max shadow-xl z-10"><li class="px-2 py-1.5"><a href=https://Jimall.github.io/>Thoughts</a></li><li class="px-2 py-1.5"><a href=https://Jimall.github.io/technology/>Technology</a></li></ul></div><div class="ml-2 sep hidden sm:block"></div><div class="ml-2 relative flex items-center"><svg id="search_btn" class="cursor-pointer" width="18" height="18" viewBox="2 0 20 20"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61.0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg></svg><div id=search_menu_wrapper class="hidden justify-center fixed top-0 left-0 w-full h-full z-40"><div id=search_menu class="fixed flex flex-col w-full h-full sm:h-auto sm:top-24 sm:bottom-24 rounded-none sm:rounded-md sm:w-120 z-50"><div class="flex min-h-10 shadow-md"><div class="flex flex-grow"><input id=search_menu_input class="flex-grow focus:outline-none px-4 rounded-tl-md" type=text placeholder></div><div id=search_menu_close_btn class="flex items-center justify-center w-10 rounded-tr-md cursor-pointer"><svg width="14" height="14" viewBox="3 3 18 18"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></svg></div></div><div id=search_menu_results class="flex-grow overflow-y-auto"></div></div></div></div></div></div><nav id=navbar class="mt-3 hidden xl:block"><ul class=flex><li class="navbar-item text-sm border-b-2 pb-1 mr-2 font-medium inactive"><a href=/posts/leetcode/problem/>Leetcode</a></li><li class="navbar-item text-sm border-b-2 pb-1 mr-2 font-medium insection"><a href=/posts/java/java%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6/>Java</a></li><li class="navbar-item-dropdown text-sm border-b-2 pb-1 mr-2 font-medium insection"><div class="flex items-center"><a href>Java</a><svg width="18" height="18" viewBox="3 3 18 18"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M7 10l5 5 5-5z"/></svg></svg></div><ul class="navbar-dropdown mt-1.5 -ml-2.5"><li><a class=block href=/posts/java/java%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6/>Map接口</a></li></ul></li></ul></nav><nav id=navbar_sm class="mt-2 hidden"><ul><li class="text-sm mt-2"><a href=/posts/leetcode/problem/>Leetcode</a></li><li class="text-sm mt-2"><a href=/posts/java/java%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6/>Java</a></li><li class="text-sm mt-2"><a href>Java</a><ul><li class="text-sm mt-2"><a href=/posts/java/java%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6/>Map接口</a></li></ul></li></ul><hr class=my-4></nav></header><div id=content class=my-8><div class="collapsible-menu-wrapper my-8 p-4 border-2 rounded"><div class="flex justify-between"><span class=font-bold></span></div><div class="collapsible-menu text-sm ml-2"><div class=leading-6><nav id=TableOfContents><ul><li><a href=#map-接口-api>Map 接口 api</a></li><li><a href=#常用集合>常用集合</a><ul><li><a href=#hashmap>HashMap</a></li><li><a href=#linkedhashmap>LinkedHashMap</a></li><li><a href=#treemap>TreeMap</a></li><li><a href=#concurrenthashmap>ConcurrentHashMap</a></li><li><a href=#hashtable>Hashtable</a></li></ul></li></ul></nav></div></div></div><div class=my-7><article class=line-numbers><p>图示：</p><p><img src=https://cdn.jsdelivr.net/gh/SUSTechee/images/blog/20210310083541.png alt></p><p>Map 通过 key-value 形式存元素，每个元素称为 entry，即一个 entry 包含 key 和 value 两个值。</p><h2 id=map-接口-api>Map 接口 api</h2><p>信息：isEmpty(), size()</p><p>添加修改：put(key, value) 如果 key 存在就会修改，否则添加</p><p>查找：containKey(), containValue()</p><p>遍历：entrySet() 返回映射关系的 set 视图，keySet() 返回 key 的 set 视图，values() 返回 value 的 collection 视图</p><p>删除：remove(key)，clear()</p><h2 id=常用集合>常用集合</h2><h3 id=hashmap>HashMap</h3><p>了解 HashMap，首先需要了解哈希算法：</p><p><a href=https://www.cnblogs.com/higerMan/p/11907117.html>哈希冲突及四种解决方法</a></p><p>四种解决方法：</p><ol><li><p>开放地址法
1.</p></li><li><p>拉链法</p></li><li><p>建立公共溢出区</p><p>建立公共溢出区存储所有哈希冲突的数据。</p></li><li><p>再哈希法</p></li></ol><p>然后需要了解红黑树：</p><p><a href=https://blog.csdn.net/v_JULY_v/article/details/6105630>红黑树介绍和实现</a></p><p>总结：</p><ul><li>红黑树是平衡的二叉查找树，和 AVL tree 是类似的，不同的是 AVL tree 和红黑树维持平衡的规则不太一样。</li><li>红黑树的关键性质：<ul><li>每个结点要么是红的要么是黑的。</li><li>根结点是黑的。</li><li>每个叶结点（叶结点即指树尾端NIL指针或NULL结点）都是黑的。</li><li>如果一个结点是红的，那么它的两个儿子都是黑的。</li><li>对于任意结点而言，其到叶结点树尾端NIL指针的每条路径都包含相同数目的黑结点。</li></ul></li><li>理解红黑树的关键是理解平衡和理解二叉查找树，二叉查找树插入、删除和查找的开销都是 O(h)，由于红黑树平衡，那么 h 最大为 log(n)，所以红黑树插入、删除和查找的开销为 log(n)</li></ul><p>开始看 HashMap 解析博文，根据博文再看 HashMap 源码进行理解：</p><p><a href=https://zhuanlan.zhihu.com/p/38615394>HashMap 结构详解</a></p><p><a href=https://zhuanlan.zhihu.com/p/127147909>HashMap 详解</a></p><p><a href=https://zhuanlan.zhihu.com/p/127147909>HashMap 原理详解（面试题）</a></p><p>总结：</p><ul><li>HashMap 的底层是数组、链表和红黑树</li><li>数组是用于进行映射的，hashCode 之后就可以直接存在数组上，然后就可以 O(1) 查找，同时数组长度不够的时候带有扩容机制 resize，但是注意 resize 是很耗性能的</li><li>hashCode 之后会产生 hash 碰撞，这样在数组上的同一位置会有多个结果，所以用链表串起来，在查找的时候再搜一遍链表即可</li><li>链表的搜索复杂度为 O(n)，这样链表太长的情况下会很慢，这个时候，把链表想象成极端情况下的二叉树，就不难想到把链表平衡树化，采取的操作是构建为红黑树，这样平衡之后就可以 O(logn) 搜索</li><li>HashMap 线程不安全</li></ul><h3 id=linkedhashmap>LinkedHashMap</h3><p>LinkedHashMap 和 HashMap 几乎一样，事实上，LinkedHashMap 继承自 HashMap 唯一的不同在于遍历顺序上：</p><p><a href=https://sunweiguo.github.io/2019/01/20/java-collection/8.HashMap%E5%92%8CLinkedHashMap%E9%81%8D%E5%8E%86%E6%9C%BA%E5%88%B6/>LinkedHashMap 和 HashMap 比较</a></p><p>总结：</p><ul><li><code>HashMap</code>的输出顺序与元素的输入顺序无关，因为遍历的时候它自己根据读取方便来确定散列值取数据，<code>LinkedHashMap</code>可以按照输入顺序输出，也可以根据读取元素的顺序输出</li></ul><p><a href=https://www.jianshu.com/p/181df0893158>LinkedHashMap 详解</a></p><p>总结：</p><ul><li>LinkedHashMap 维护了一个 LinkedHashMapEntry 双向链表，在遍历的时候 iterator 在 LinkedHashMapEntry 上遍历。</li></ul><h3 id=treemap>TreeMap</h3><p><a href=https://www.jianshu.com/p/d9ad7f6d75a0>TreeMap 详解</a></p><p>总结：</p><ul><li>TreeMap 就是一棵红黑树，有可以排序的特性</li></ul><p><a href="https://blog.csdn.net/xlgen157387/article/details/47907721#:~:text=HashMap%E5%92%8CTreeMap%E6%AF%94%E8%BE%83,Map%E6%97%B6%E5%80%99%E6%89%8D%E7%94%A8TreeMap.">TreeMap 和 HashMap 的比较</a></p><p>总结：</p><ul><li>HashMap:适用于在Map中插入、删除和定位元素。</li><li>Treemap:适用于按自然顺序或自定义顺序遍历键（key）。</li><li>HashMap通常比TreeMap快一点（树和哈希表的数据结构使然），建议多使用HashMap,在需要排序的Map时候才用TreeMap.</li><li>HashMap 非线程安全 TreeMap 非线程安全</li><li>HashMap的结果是没有排序的，而TreeMap输出的结果是排好序的。</li></ul><h3 id=concurrenthashmap>ConcurrentHashMap</h3><p><a href=https://zhuanlan.zhihu.com/p/40327960>ConcurrentHashMap 和 HashMap 的对比</a></p><p>总结：</p><ul><li>ConcurrentHashMap 采用了分段锁技术，其中 Segment 继承于 ReentrantLock。不会像 HashTable 那样不管是 put 还是 get 操作都需要做同步处理，理论上 ConcurrentHashMap 支持 CurrencyLevel (Segment 数组数量)的线程并发。每当一个线程占用锁访问一个 Segment 时，不会影响到其他的 Segment。</li></ul><h3 id=hashtable>Hashtable</h3><p>Hashtable 和 HashMap 实现很类似，但是有一定的不同：</p><p><strong>1.实现</strong>：HashMap继承的类是AbstractMap类，而Hashtable继承的是Dictionary类，而Dictionary是一个过时的类，因此通常情况下建议使用HashMap而不是使用Hashtable</p><p><strong>2.内部结构</strong>：其实HashMap与Hashtable内部基本都是使用<strong>数组-链表</strong>的结构，但是HashMap引入了红黑树的实现，内部相对来说更加复杂而性能相对来说应该更好</p><p><strong>3.NULL值控制</strong>：通过前面的介绍我们知道Hashtable是不允许key-value为null值的，Hashtable对于key-value为空的情况下将抛出NullPointerException，而HashMap则是允许key-value为null的，HashMap会将key=null方法index=0的位置。</p><p><strong>4.线程安全</strong>：通过阅读源码可以发现Hashtable的方法中基本上都是有synchronized关键字修饰的，但是HashMap是线程不安全的，故对于单线程的情况下来说HashMap的性能更优于Hashtable，单线程场景下建议使用HashMap.</p><p>在源码里面经常出现 transient 关键字：<a href=https://www.cnblogs.com/lanxuezaipiao/p/3369962.html>transient 关键字</a>，总结来说就是：为我们提供了便利，你只需要实现Serilizable接口，将不需要序列化的属性前添加关键字transient，序列化对象的时候，这个属性就不会序列化到指定的目的地中</p></article></div></div><footer class="my-8 w-full text-center text-xs"><article>KON！</article></footer></main><script src=/js/header.0b11855b871cb4d10c6c07b6723b9209f5c2bc9100735ab6ff47c8f9b76bb3d6ae41b488083b5fb15697987334039eb651b25c83228c29ac48a2bc168db8a894.js integrity="sha512-CxGFW4cctNEMbAe2cjuSCfXCvJEAc1q2/0fI+bdrs9auQbSICDtfsVaXmHM0A562UbJcgyKMKaxIorwWjbiolA=="></script><script src=/js/multilingual.84eb767ebf77f5840471f65eceeb3b8a86b56bff9bf4de1e1da7caa0331440cd7ecfeff6bb26884c7ce0df1e258ed80ec90c80a92bb2fa2bbe550c602c181bbe.js integrity="sha512-hOt2fr939YQEcfZezus7ioa1a/+b9N4eHafKoDMUQM1+z+/2uyaITHzg3x4ljtgOyQyAqSuy+iu+VQxgLBgbvg=="></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script src=/js/math.d7efde37b2eb8879651e1f4489bcd4d8203b8c2bf8ca12c9e1b8cd11bfd6395b172f4999fff43ce0d047889a2bdb71ee74aebbae5327590192d1144e790fcd7b.js integrity="sha512-1+/eN7LriHllHh9EibzU2CA7jCv4yhLJ4bjNEb/WOVsXL0mZ//Q84NBHiJor23HudK67rlMnWQGS0RROeQ/New=="></script><script src=/js/search-en-us.min.45b851b784c6177f23176505286d0a59d28d4c06a0e057bcec8e3c2bc1b72d5c0a6a475caf1c6636ec08a57fe92406d440482afc54709a8c136b7f93b76df1e6.js integrity="sha512-RbhRt4TGF38jF2UFKG0KWdKNTAag4Fe87I48K8G3LVwKakdcrxxmNuwIpX/pJAbUQEgq/FRwmowTa3+Tt23x5g=="></script></body></html>